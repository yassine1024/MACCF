CREATE TRIGGER `MESSAGE_DEBIT_CREDIT` AFTER UPDATE ON `client`
 FOR EACH ROW BEGIN
	DECLARE MSG VARCHAR(500);
	DECLARE DESTINATAIRE VARCHAR(100);

	SET @DESTINATAIRE := (SELECT Mail FROM CLIENT WHERE NUM_CPT=NEW.NUM_CPT) ;

	IF @DESTINATAIRE IS NOT NULL THEN
		IF NEW.SOLDE_ACTUEL < OLD.SOLDE_ACTUEL  THEN
			SET @MSG := CONCAT('N°: ',NEW.NUM_CPT,' a été débité, votre solde actuel est : ',NEW.SOLDE_ACTUEL) ;
			INSERT INTO MESSAGE (DESTINATAIRE,MSG)
			VALUE
				(@DESTINATAIRE,@MSG);
		ELSE IF NEW.SOLDE_ACTUEL > OLD.SOLDE_ACTUEL THEN
			SET @MSG := CONCAT('N°: ',NEW.NUM_CPT,' a été crédité, votre solde actuel est : ',NEW.SOLDE_ACTUEL) ;
			INSERT INTO MESSAGE (DESTINATAIRE,MSG)
			VALUE
				(@DESTINATAIRE,@MSG);
			END IF;
		END IF;
	END IF;

END